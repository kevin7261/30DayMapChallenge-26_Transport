(function(){"use strict";var e={3604:function(e,t,o){var a=o(5130),n=o(657),r=o(6768);const l={id:"app",class:"d-flex flex-column vh-100"},s={class:"d-flex flex-column overflow-hidden"};function i(e,t,o,a,n,i){const c=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",s,[(0,r.bF)(c)])])}var c={name:"App"},u=o(1241);const p=(0,u.A)(c,[["render",i]]);var d=p,f=o(1387);const g={class:"vh-100 vw-100 overflow-hidden"};function v(e,t,o,a,n,l){const s=(0,r.g2)("MapTab");return(0,r.uX)(),(0,r.CE)("div",g,[(0,r.bF)(s,{onMapReady:a.setMapInstance},null,8,["onMapReady"])])}var h=o(4232);const m={id:"map-container",class:"h-100 w-100 position-relative bg-transparent z-0"},b=["id"],y={class:"position-absolute",style:{top:"50%",left:"0",transform:"translateY(-50%)","z-index":"1000",padding:"1rem"}},M={class:"bg-dark bg-opacity-75 rounded-3 p-3"},w={class:""},T={class:"d-flex flex-column gap-1"};function x(e,t,o,a,n,l){return(0,r.uX)(),(0,r.CE)("div",m,[(0,r.Lk)("div",{id:a.mapContainerId,ref:"mapContainer",class:"h-100 w-100"},null,8,b),(0,r.Lk)("div",y,[(0,r.Lk)("div",M,[(0,r.Lk)("div",w,[(0,r.Lk)("div",T,[(0,r.Lk)("button",{type:"button",class:(0,h.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["map"===a.displayMode?"active":""]]),onClick:t[0]||(t[0]=e=>a.toggleDisplayMode("map"))}," åœ°åœ–æ¨¡å¼ ",2),(0,r.Lk)("button",{type:"button",class:(0,h.C4)(["btn border-0 my-country-btn my-font-sm-white px-4 py-3",["grid"===a.displayMode?"active":""]]),onClick:t[1]||(t[1]=e=>a.toggleDisplayMode("grid"))}," ç¶²æ ¼æ¨¡å¼ ",2)])])])])])}o(4114),o(8111),o(2489),o(7588),o(1701);var k=o(144),_=o(1320);const N=(0,n.nY)("data",(()=>{const e=(0,k.KR)(null),t=t=>{e.value=t};return{mapInstance:e,setMapInstance:t}}),{persist:!0});
/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ—ºï¸ MapTab.vue - D3.js å°ç£åœ°åœ–çµ„ä»¶
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 * @fileoverview
 * é€™æ˜¯ä¸€å€‹åŸºæ–¼ D3.js çš„å°ç£åœ°åœ–è¦–è¦ºåŒ–çµ„ä»¶ï¼ŒåŒæ™‚é¡¯ç¤ºç¸£å¸‚ç•Œç·šå’Œç™»é©ç†±ç¶²æ ¼æ•¸æ“šã€‚
 * æœ¬çµ„ä»¶è² è²¬è¼‰å…¥ã€è™•ç†å’Œæ¸²æŸ“å°ç£ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šå’Œç™»é©ç†±ç—…ä¾‹ç¶²æ ¼æ•¸æ“šã€‚
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * 1. ç¸£å¸‚é‚Šç•Œæ¸²æŸ“ï¼š
 *    âœ“ è¼‰å…¥ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š1140318.geojson
 *    âœ“ ç¹ªè£½æ‰€æœ‰å°ç£ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š
 *
 * 2. ç™»é©ç†±ç¶²æ ¼æ¸²æŸ“ï¼š
 *    âœ“ è¼‰å…¥ dengue_grid_counts_1km_2023_land_only.geojson
 *    âœ“ æ ¹æ“š level å±¬æ€§ç¹ªè£½5ç´šé¢¨éšªç­‰ç´šç¶²æ ¼
 *    âœ“ åªé¡¯ç¤ºç—…ä¾‹æ•¸ > 0 çš„ç¶²æ ¼
 *    âœ“ ä½¿ç”¨5ç´šè‰²ç¥¨ï¼šæ·±è—(1) â†’ ç¶ (2) â†’ é»ƒæ©™(3) â†’ æ©™(4) â†’ ç´…(5)ï¼ˆæœ€ä¸Šå±¤ï¼‰
 *
 * 3. è¦–è¦ºå…ƒç´ ï¼š
 *    âœ“ ç¸£å¸‚ç•Œç·šï¼šæ·ºç°ç´°é‚Šæ¡†ï¼Œç„¡å¡«å……ï¼ˆåº•å±¤ï¼‰
 *    âœ“ ç™»é©ç†±ç¶²æ ¼ï¼š5ç´šè‰²ç¥¨å¡«å……ï¼Œç„¡é‚Šæ¡†ï¼ˆæœ€ä¸Šå±¤ï¼‰
 *    âœ“ ç™½è‰²åœ°åœ–èƒŒæ™¯
 *
 * 4. äº¤äº’åŠŸèƒ½ï¼š
 *    âœ“ æ»¾è¼ªç¸®æ”¾æ§åˆ¶
 *    âœ“ æ‹–å‹•å¹³ç§»å°èˆª
 *    âœ“ æ»‘é¼ æ‡¸åœé¡¯ç¤ºç¶²æ ¼å±¬æ€§è³‡è¨Š
 *    âœ“ ç¶²æ ¼é«˜äº®æ•ˆæœ
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ¨ é…è‰²ä¸»é¡Œ
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ç™½è‰²      #ffffff  â†’ åœ°åœ–èƒŒæ™¯
 * æ·ºç°è‰²    #cccccc  â†’ ç¸£å¸‚é‚Šæ¡†
 * ç„¡å¡«å……    none     â†’ ç¸£å¸‚å€åŸŸ
 * 5ç´šè‰²ç¥¨            â†’ ç™»é©ç†±é¢¨éšªç­‰ç´šï¼ˆæœ€ä¸Šå±¤ï¼‰
 *   Level 1  #1a237e â†’ æ·±è—è‰²
 *   Level 2  #4caf50 â†’ ç¶ è‰²
 *   Level 3  #fbc02d â†’ é»ƒæ©™è‰²
 *   Level 4  #ff6f00 â†’ æ©™è‰²
 *   Level 5  #d32f2f â†’ ç´…è‰²
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ› ï¸ æŠ€è¡“æ£§
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * @requires vue                 - Vue 3.2+ (Composition API)
 * @requires d3                  - D3.js 7.8+ (åœ°åœ–ç¹ªè£½åº«)
 * @requires @/stores/dataStore  - Pinia ç‹€æ…‹ç®¡ç†
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ“ æ•¸æ“šä¾†æº
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šï¼šç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š1140318.geojson
 * ç™»é©ç†±ç¶²æ ¼æ•¸æ“šï¼šdengue_grid_counts_1km_2023_land_only.geojson
 * è·¯å¾‘ï¼špublic/data/geojson/
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ”§ ä½¿ç”¨æ–¹å¼
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * <MapTab @map-ready="handleMapReady" />
 *
 * @event map-ready - åœ°åœ–åˆå§‹åŒ–å®Œæˆæ™‚è§¸ç™¼ï¼Œè¿”å›åœ°åœ–å¯¦ä¾‹
 *
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * ğŸ“ ç¶­è­·è€…
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * @author Kevin Cheng
 * @version 4.0.0
 * @since 2024
 * @license MIT
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */var A={name:"MapTab",emits:["map-ready"],setup(e,{emit:t}){N();const o=(0,k.KR)(null);let a=null,n=null,l=null,s=null,i=null,c=null,u=null;const p=(0,k.KR)(!1),d=(0,k.KR)(`leaflet-map-${Math.random().toString(36).substr(2,9)}`),f=(0,k.KR)("map"),g=(0,k.KR)(null),v=(0,k.KR)(null),h=((0,k.KR)(null),async()=>{try{console.log("[MapTab] é–‹å§‹è¼‰å…¥ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON æ•¸æ“š...");const e=await fetch("/30DayMapChallenge-26_Transport/data/geojson/è‡ºåŒ—å¸‚å€ç•Œåœ–_20220915.geojson");if(!e.ok)throw new Error(`ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“šè¼‰å…¥å¤±æ•—: HTTP ${e.status}`);return g.value=await e.json(),console.log("[MapTab] è‡ºåŒ—å¸‚å€ç•Œæ•¸æ“šè¼‰å…¥æˆåŠŸ"),console.log("  - å€æ•¸é‡:",g.value.features?.length||0),!0}catch(e){return console.error("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“šè¼‰å…¥å¤±æ•—:",e),!1}}),m=()=>{if(!o.value)return;const e=o.value.querySelector(".map-tooltip");e&&e.remove(),c=document.createElement("div"),c.className="map-tooltip",c.style.position="absolute",c.style.pointerEvents="none",c.style.opacity="0",c.style.padding="4px 8px",o.value.appendChild(c),console.log("[MapTab] å·¥å…·æç¤ºå…ƒç´ å‰µå»ºæˆåŠŸ")},b=async()=>{try{console.log("[MapTab] é–‹å§‹è¼‰å…¥ 500m æ–¹æ ¼ GeoJSON æ•¸æ“š...");const e=await fetch("/30DayMapChallenge-26_Transport/data/geojson/grid_with_weighted_angle_stats_500m.geojson");if(!e.ok)throw new Error(`æ–¹æ ¼æ•¸æ“šè¼‰å…¥å¤±æ•—: HTTP ${e.status}`);return v.value=await e.json(),console.log("[MapTab] 500m æ–¹æ ¼æ•¸æ“šè¼‰å…¥æˆåŠŸ"),console.log("  - ç¶²æ ¼æ•¸é‡:",v.value.features?.length||0),!0}catch(e){return console.error("[MapTab] 500m æ–¹æ ¼æ•¸æ“šè¼‰å…¥å¤±æ•—:",e),!1}},y=()=>{if(i&&g.value)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON"),i.selectAll(".county").data(g.value.features).enter().append("path").attr("d",l).attr("class","county").attr("fill","none").attr("stroke","#222").attr("stroke-width",1.2).attr("stroke-opacity",.9).attr("vector-effect","non-scaling-stroke"),console.log("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON ç¹ªè£½å®Œæˆ")}catch(e){console.error("[MapTab] ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š GeoJSON ç¹ªè£½å¤±æ•—:",e)}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·š: g=",!!i,"countyData=",!!g.value)},M=()=>{if(!o.value)return!1;const e=o.value.getBoundingClientRect();if(0===e.width||0===e.height)return console.warn("[MapTab] å®¹å™¨å°ºå¯¸ç‚ºé›¶ï¼Œå»¶é²åˆå§‹åŒ–"),!1;try{a&&a.remove(),n=null,l=null,u=null;const t=e.width,r=e.height;return a=_.Ltv(o.value).append("svg").attr("width",t).attr("height",r).style("background","#ffffff"),i=a.append("g"),s=_.s_O().scaleExtent([.5,50]).on("zoom",(e=>{i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,_.GSI),m(),p.value=!0,console.log("[MapTab] ç¶²æ ¼ç•«å¸ƒå‰µå»ºæˆåŠŸ"),!0}catch(t){return console.error("[MapTab] ç¶²æ ¼ç•«å¸ƒå‰µå»ºå¤±æ•—:",t),!1}},w=()=>{if(i&&v.value)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½æ–¹æ ¼ï¼ˆGrid æ¨¡å¼ï¼Œä½¿ç”¨ grid_x/grid_yï¼‰"),i.selectAll(".hex-grid").remove(),i.selectAll(".county").remove();const e=(v.value.features||[]).filter((e=>{const t=e?.properties?.grid_x,o=e?.properties?.grid_y;return Number.isFinite(t)&&Number.isFinite(o)}));if(0===e.length)return console.warn("[MapTab] ç„¡æ³•æ‰¾åˆ° grid_x æˆ– grid_y å±¬æ€§"),void(u=null);const t=e.map((e=>e.properties.grid_x)),n=e.map((e=>e.properties.grid_y)),r=_.jkA(t),l=_.T9B(t),s=_.jkA(n),p=_.T9B(n),d=(a?+a.attr("width"):null)||o.value.getBoundingClientRect().width,f=(a?+a.attr("height"):null)||o.value.getBoundingClientRect().height;if(!Number.isFinite(d)||!Number.isFinite(f)||0===d||0===f)return console.warn("[MapTab] SVG å°ºå¯¸ç„¡æ•ˆï¼Œç„¡æ³•ç¹ªè£½ grid"),void(u=null);const g=40,h=Math.max(d-2*g,0),m=Math.max(f-2*g,0),b=Math.max(l-r+1,1),y=Math.max(p-s+1,1),M=Math.min(h/b,m/y);if(!Number.isFinite(M)||M<=0)return console.warn("[MapTab] è¨ˆç®—å‡ºçš„ cellSize ç„¡æ•ˆ:",M),void(u=null);const w=M*b,T=M*y,x=(d-w)/2,k=(f-T)/2;u={minX:r,maxX:l,minY:s,maxY:p,cellSize:M,offsetX:x,offsetY:k};const N=Math.max(.06*M,.4),C=i.selectAll(".hex-grid").data(e,(e=>`${e.properties.grid_x}-${e.properties.grid_y}`)).join("rect").attr("class","hex-grid").attr("x",(e=>x+(e.properties.grid_x-r)*M)).attr("y",(e=>k+(p-e.properties.grid_y)*M)).attr("width",M).attr("height",M).attr("fill","none").attr("stroke","#999").attr("stroke-width",N).attr("stroke-opacity",.7).attr("shape-rendering","crispEdges").attr("vector-effect","non-scaling-stroke").style("cursor","pointer");C.on("mouseover",(function(e,t){if(_.Ltv(this).attr("stroke-width",1.3*N).attr("stroke-opacity",1),c){const a=t.properties||{};let n="";Object.keys(a).forEach((e=>{const t=a[e];n+=`<div><strong>${e}:</strong> ${null!==t&&void 0!==t?t:"N/A"}</div>`})),c.innerHTML=n;const[r,l]=_.WnM(e,o.value);c.style.left=r+10+"px",c.style.top=l-10+"px",c.style.opacity=1}})).on("mousemove",(function(e){if(c){const[t,a]=_.WnM(e,o.value);c.style.left=t+10+"px",c.style.top=a-10+"px"}})).on("mouseout",(function(){_.Ltv(this).attr("stroke-width",N).attr("stroke-opacity",.7),c&&(c.style.opacity=0)})),console.log("[MapTab] æ–¹æ ¼ï¼ˆGrid æ¨¡å¼ï¼‰ç¹ªè£½å®Œæˆ",{cells:e.length,cellSize:M,offsetX:x,offsetY:k}),A()}catch(e){console.error("[MapTab] æ–¹æ ¼ç¹ªè£½å¤±æ•—:",e),u=null}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½æ–¹æ ¼: g=",!!i,"hexData=",!!v.value)},T=async e=>{if(f.value=e,console.log("[MapTab] åˆ‡æ›é¡¯ç¤ºæ¨¡å¼:",e),"map"===f.value){if(u=null,g.value||await h(),v.value||await b(),a&&!n&&(a.remove(),a=null),n&&l)a&&s&&a.call(s.transform,_.GSI);else{const e=o.value.getBoundingClientRect();if(e.width>0&&e.height>0){const t=e.width,r=e.height;a&&a.remove(),a=_.Ltv(o.value).append("svg").attr("width",t).attr("height",r).style("background","#ffffff"),n=_.bAh(),g.value?n.fitExtent([[20,20],[t-20,r-20]],g.value):n.center([121,25.05]).scale(45e3).translate([t/2,r/2]),l=_.zFW().projection(n),i=a.append("g"),s=_.s_O().scaleExtent([.8,12]).on("zoom",(e=>{i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,_.GSI),m(),p.value=!0}}y(),x()}else{if(g.value=null,u=null,v.value||await b(),!M())return void console.warn("[MapTab] Grid ç•«å¸ƒå»ºç«‹å¤±æ•—ï¼Œæš«åœç¹ªåœ–");w()}},x=()=>{if(i&&v.value&&l)try{console.log("[MapTab] é–‹å§‹ç¹ªè£½æ–¹æ ¼ GeoJSON"),i.selectAll(".hex-grid").remove(),console.log("[MapTab] ä½¿ç”¨ Map æ¨¡å¼ç¹ªè£½ï¼ˆåœ°åœ–æŠ•å½±ï¼‰"),console.log("[MapTab] path generator:",!!l,"g:",!!i);const e=i.selectAll(".hex-grid").data(v.value.features).enter().append("path").attr("d",l).attr("class","hex-grid").attr("fill","none").attr("stroke","#999").attr("stroke-width",.5).attr("stroke-opacity",.7).attr("shape-rendering","crispEdges").attr("vector-effect","non-scaling-stroke").style("cursor","pointer");console.log("[DEBUG] ç¹ªè£½äº†å¤šå°‘å€‹ path å…ƒç´ :",e.size()),e.on("mouseover",(function(e,t){if(_.Ltv(this).attr("fill-opacity",1).attr("stroke-width",2),c){const a=t.properties;let n="";Object.keys(a).forEach((e=>{const t=a[e];n+=`<div><strong>${e}:</strong> ${null!==t&&void 0!==t?t:"N/A"}</div>`})),c.innerHTML=n;const[r,l]=_.WnM(e,o.value);c.style.left=r+10+"px",c.style.top=l-10+"px",c.style.opacity=1}})).on("mousemove",(function(e){if(c){const[t,a]=_.WnM(e,o.value);c.style.left=t+10+"px",c.style.top=a-10+"px"}})).on("mouseout",(function(){_.Ltv(this).attr("fill-opacity",.8).attr("stroke-width",.5),c&&(c.style.opacity=0)})),console.log("[MapTab] æ–¹æ ¼ï¼ˆåœ°åœ–æ¨¡å¼ï¼‰ç¹ªè£½å®Œæˆ"),console.log("  - SVG ä¸­çš„ path å…ƒç´ æ•¸é‡:",i.selectAll("path").size()),console.log("  - hex-grid class å…ƒç´ æ•¸é‡:",i.selectAll(".hex-grid").size()),A()}catch(e){console.error("[MapTab] æ–¹æ ¼ç¹ªè£½å¤±æ•—:",e)}else console.error("[MapTab] ç„¡æ³•ç¹ªè£½æ–¹æ ¼: g=",!!i,"hexData=",!!v.value,"path=",!!l)},A=()=>{if(!i||!v.value)return;const e="grid"===f.value;i.selectAll(".angle-arrows").remove();const t=i.append("g").attr("class","angle-arrows").attr("pointer-events","none");t.raise&&t.raise();const o=v.value.features||[];let a=0,r=0,s=[];o.forEach(((o,i)=>{const c=o.properties?.["å€Ÿè»Šè§’åº¦å¹³å‡"],p=o.properties?.["é‚„è»Šè§’åº¦å¹³å‡"],d=o?.properties?.grid_x,f=o?.properties?.grid_y;if(!Number.isFinite(d)||!Number.isFinite(f))return;let g,v,h=12;if(e&&u){const{cellSize:e,offsetX:t,offsetY:o,minX:a,maxY:n}=u;g=t+(d-a+.5)*e,v=o+(n-f+.5)*e,h=Math.max(Math.min(.42*(e||0),22),5)}else{if(!n||!l)return;try{const e=_.Ewd(o),t=n(e);if(g=t?.[0],v=t?.[1],Number.isFinite(g)&&Number.isFinite(v)||([g,v]=l.centroid(o)),Number.isFinite(g)&&Number.isFinite(v))try{const e=l.bounds(o);if(e&&2===e.length){const t=Math.abs(e[1][0]-e[0][0]),o=Math.abs(e[1][1]-e[0][1]),a=Math.min(t,o);h=Number.isFinite(a)&&a>0?Math.max(Math.min(.4*a,26),6):14}}catch(T){h=14}}catch(x){try{[g,v]=l.centroid(o),h=14}catch(T){return void console.warn("Centroid calculation failed:",T)}}}if(!Number.isFinite(g)||!Number.isFinite(v))return;i<5&&(c||p)&&s.push({gridX:d,gridY:f,cx:g,cy:v,borrowDeg:c,returnDeg:p});const m=(e,o,a,n,r=!1)=>{if(null===e||void 0===e||Number.isNaN(e))return;const l=(e-90)*Math.PI/180,s=Math.cos(l)*h,i=Math.sin(l)*h,c=0,u=0,p=r?g+c-s:g+c,d=r?v+u-i:v+u,f=r?g+c:g+c+s,m=r?v+u:v+u+i;t.append("line").attr("x1",p).attr("y1",d).attr("x2",f).attr("y2",m).style("stroke",o).attr("stroke-width",Math.max(.12*h,1.6)).attr("stroke-linecap","round").attr("stroke-opacity",1).attr("class","angle-arrow")},b=t.selectAll(".angle-arrow").size();null===c||void 0===c||Number.isNaN(c)||m(c,"#4caf50","arrow-borrow",1,!1);const y=t.selectAll(".angle-arrow").size();y>b&&a++;const M=t.selectAll(".angle-arrow").size();null===p||void 0===p||Number.isNaN(p)||m(p+180,"#0068b7","arrow-return",-1,!0);const w=t.selectAll(".angle-arrow").size();w>M&&r++}));let c=null;try{c=t.node()?.getBBox?.()}catch(p){c=null}t.raise&&t.raise(),console.log("[MapTab] è§’åº¦ç®­é ­ç¹ªè£½å®Œæˆ",{mode:e?"grid":"map",features:o.length,validBorrow:a,validReturn:r,totalArrows:t.selectAll(".angle-arrow").size(),bbox:c,sampleCentroids:s})},C=(e=null)=>{if(!o.value)return!1;const r=o.value.getBoundingClientRect();if(0===r.width||0===r.height)return console.warn("[MapTab] å®¹å™¨å°ºå¯¸ç‚ºé›¶ï¼Œå»¶é²åˆå§‹åŒ–"),!1;try{const c=r.width,u=r.height;return a=_.Ltv(o.value).append("svg").attr("width",c).attr("height",u).style("background","#ffffff"),n=_.bAh(),e?n.fitExtent([[20,20],[c-20,u-20]],e):n.center([121,25.05]).scale(45e3).translate([c/2,u/2]),l=_.zFW().projection(n),i=a.append("g"),s=_.s_O().scaleExtent([.8,12]).on("zoom",(e=>{i.attr("transform",e.transform)})),a.call(s),a.call(s.transform,_.GSI),m(),p.value=!0,t("map-ready",{svg:a,projection:n,path:l}),console.log("[MapTab] D3.js åœ°åœ–å‰µå»ºæˆåŠŸ"),!0}catch(c){return console.error("[MapTab] D3.js åœ°åœ–å‰µå»ºå¤±æ•—:",c),!1}},E=async()=>{let e=0;const t=20;if("map"===f.value){console.log("[MapTab] é–‹å§‹è¼‰å…¥åœ°åœ–æ¨¡å¼æ•¸æ“š...");const[o,a]=await Promise.all([h(),b()]);if(!o)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥ç›´è½„å¸‚ã€ç¸£(å¸‚)ç•Œç·šæ•¸æ“š");if(!a)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ‰€æœ‰æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹å‰µå»ºåœ°åœ–");const n=async()=>{e>=t?console.error("[MapTab] åœ°åœ–åˆå§‹åŒ–å¤±æ•—ï¼Œå·²é”åˆ°æœ€å¤§å˜—è©¦æ¬¡æ•¸"):(e++,console.log(`[MapTab] å˜—è©¦å‰µå»ºåœ°åœ– (${e}/${t})`),C(g.value)?(console.log("[MapTab] åœ°åœ–å‰µå»ºæˆåŠŸï¼Œé–‹å§‹ç¹ªè£½åœ–å±¤"),y(),x()):(console.log("[MapTab] åœ°åœ–å‰µå»ºå¤±æ•—ï¼Œ100ms å¾Œé‡è©¦"),setTimeout(n,100)))};n()}else{console.log("[MapTab] é–‹å§‹è¼‰å…¥ç¶²æ ¼æ¨¡å¼æ•¸æ“š...");const o=await b();if(!o)return void console.error("[MapTab] ç„¡æ³•è¼‰å…¥å…­è§’å½¢ç¶²æ ¼æ•¸æ“š");console.log("[MapTab] æ•¸æ“šè¼‰å…¥å®Œæˆï¼Œé–‹å§‹å‰µå»ºç¶²æ ¼è¦–åœ–");const a=async()=>{e>=t?console.error("[MapTab] ç¶²æ ¼åˆå§‹åŒ–å¤±æ•—ï¼Œå·²é”åˆ°æœ€å¤§å˜—è©¦æ¬¡æ•¸"):(e++,console.log(`[MapTab] å˜—è©¦å‰µå»ºç¶²æ ¼è¦–åœ– (${e}/${t})`),C()?(console.log("[MapTab] ç¶²æ ¼è¦–åœ–å‰µå»ºæˆåŠŸï¼Œé–‹å§‹ç¹ªè£½å…­è§’å½¢ç¶²æ ¼"),w()):(console.log("[MapTab] ç¶²æ ¼è¦–åœ–å‰µå»ºå¤±æ•—ï¼Œ100ms å¾Œé‡è©¦"),setTimeout(a,100)))};a()}};let j=null;const O=()=>{j&&clearTimeout(j),j=setTimeout((()=>{console.log("[MapTab] çª—å£å¤§å°èª¿æ•´ï¼Œé‡æ–°ç¹ªè£½åœ°åœ–"),E()}),300)};return(0,r.sV)((()=>{(0,r.dY)((()=>{E()})),window.addEventListener("resize",O)})),(0,r.hi)((()=>{j&&clearTimeout(j),window.removeEventListener("resize",O),a&&(a.remove(),a=null),c&&(c.remove(),c=null),n=null,l=null,s=null,i=null,p.value=!1})),{mapContainer:o,mapContainerId:d,displayMode:f,toggleDisplayMode:T}}};const C=(0,u.A)(A,[["render",x],["__scopeId","data-v-013cff1f"]]);var E=C,j={name:"HomeView",components:{MapTab:E},setup(){const e=N(),t=t=>e.setMapInstance(t);return{setMapInstance:t}}};const O=(0,u.A)(j,[["render",v]]);var z=O;const F=[{path:"/",name:"Home",component:z}],L=(0,f.aE)({history:(0,f.LA)("/30DayMapChallenge-26_Transport/"),routes:F});var S=L;o(323);console.log("ğŸ¨ æ¨£å¼æ–‡ä»¶è¼‰å…¥å®Œæˆ");const D=(0,a.Ef)(d),R=(0,n.Ey)();D.use(S),D.use(R),D.mount("#app"),console.log("ğŸš€ ç©ºé–“åˆ†æè¦–è¦ºåŒ–å¹³å°å·²å•Ÿå‹•"),console.log("ğŸ“¦ Pinia ç‹€æ…‹ç®¡ç†å·²åˆå§‹åŒ–"),console.log("ğŸ—ºï¸ Vue Router è·¯ç”±ç³»çµ±å·²å°±ç·’"),console.log("ğŸ¨ Bootstrap 5 UI æ¡†æ¶å·²è¼‰å…¥"),console.log("ğŸ—ºï¸ D3.js åœ°åœ–åº«å·²æº–å‚™å°±ç·’"),console.log("ğŸ”¤ Font Awesome åœ–ç¤ºåº«å·²è¼‰å…¥")}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,n,r){if(!a){var l=1/0;for(u=0;u<e.length;u++){a=e[u][0],n=e[u][1],r=e[u][2];for(var s=!0,i=0;i<a.length;i++)(!1&r||l>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(s=!1,r<l&&(l=r));if(s){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,r,l=a[0],s=a[1],i=a[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(i)var u=i(o)}for(t&&t(a);c<l.length;c++)r=l[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},a=self["webpackChunk_30DayMapChallenge_26_Transport"]=self["webpackChunk_30DayMapChallenge_26_Transport"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(3604)}));a=o.O(a)})();
//# sourceMappingURL=app.9fe99091.js.map